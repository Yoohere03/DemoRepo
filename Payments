This code is written by marc
